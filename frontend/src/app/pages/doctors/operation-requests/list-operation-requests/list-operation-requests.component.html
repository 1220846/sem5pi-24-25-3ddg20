<div class="flex justify-content-end mt-2 mr-5">
    <p-button icon="pi pi-filter" (click)="filterPanel.toggle($event)" class="p-button-rounded p-button-outlined" styleClass="p-button-text"></p-button>
    <p-overlayPanel #filterPanel [dismissable]="true" [showCloseIcon]="true">
        <div class="p-fluid p-formgrid p-grid">
            <!-- Operation Type Id Filter -->
            <div class="p-field p-col-12 mt-2">
                <label for="OperationTypeId">Operation Type Id</label>
                <input id="OperationTypeId" pInputText #operationTypeIdInput class="p-input-sm" placeholder="Enter Operation Type Id" />
            </div>
    
            <!-- Status Filter -->
            <div class="p-field p-col-12 mt-2">
                <label for="status">Status</label>
                <p-dropdown [options]="optionsStatus" #statusDropdown optionLabel="label" optionValue="value" placeholder="Select Status" class="p-input-sm">
                </p-dropdown>
            </div>
    
            <!-- Priority Filter -->
            <div class="p-field p-col-12 mt-2">
                <label for="priority">Priority</label>
                <p-dropdown [options]="optionsPriority" #priorityDropdown optionLabel="label" optionValue="value" placeholder="Select Priority" class="p-input-sm">
                </p-dropdown>
            </div>
    
            <!-- Medical Record Number Filter -->
            <div class="p-field p-col-12 mt-2">
                <label for="MedicalRecordNumber">Patient Medical Record Number</label>
                <input id="MedicalRecordNumber" pInputText #medicalRecordNumberInput class="p-input-sm" placeholder="Enter Medical Record Number" />
            </div>
    
            <!-- Action Buttons -->
            <div class="p-col-12 mt-3 flex justify-content-center gap-2">
                <p-button label="Apply" (click)="applyFilters(operationTypeIdInput.value, statusDropdown.selectedOption?.value, priorityDropdown.selectedOption?.value, medicalRecordNumberInput.value)" class="p-button-sm"></p-button>
                <p-button label="Clear" (click)="clearFilters()" class="p-button-sm" severity="secondary"></p-button>
            </div>
        </div>
    </p-overlayPanel>
    
</div>

<div class="card flex justify-content-center m-5">
    <p-scroller [items]="operationRequests"
                [itemSize]="90" 
                [style]="{ height: '480px', width: '100%' }"
                scrollHeight="480px"
                styleClass="border-1 surface-border">
        <ng-template let-operationRequest pTemplate="item">
            <p-accordion class="w-full">
                <p-accordionTab>
                    <ng-template pTemplate="header">
                        <span class="flex align-items-center gap-1 w-full">
                            <div class="flex flex-column">
                                <span class="font-bold white-space-nowrap">
                                    {{ operationRequest.medicalRecordNumber }}     
                                    <span class="font-normal mr-3;">
                                        ({{ operationRequest.deadline }})
                                    </span>
                                </span>
                                <p-tag class="mt-1" 
                                       [severity]="operationRequest.status === 'SCHEDULED' ? 'success' : 'warning'" 
                                       [rounded]="true">
                                    {{ operationRequest.status.toLowerCase() }}
                                </p-tag>
                                <p-tag class="mt-1" 
                                       [severity]="getPrioritySeverity(operationRequest.priority)" 
                                       [rounded]="true">
                                    {{ operationRequest.priority.toLowerCase() }}
                                </p-tag>
                            </div>
                            <modal-update-operation-requests></modal-update-operation-requests>
                        </span>
                    </ng-template>
                    <div class="flex ml-3 gap-6">
                        <p><strong>Doctor Id:</strong> {{ operationRequest.doctorId }} </p>
                        <p><strong>Operation Type Id:</strong> {{ operationRequest.operationTypeId }} </p>
                    </div>
                </p-accordionTab>
            </p-accordion>
        </ng-template>
    </p-scroller>
</div>
